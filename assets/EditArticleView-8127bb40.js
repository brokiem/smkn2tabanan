import{Q as T,u as p,I as L}from"./imagekit-41140f27.js";/* empty css                       */import{H as I}from"./Header-f92b1b8d.js";import{S as s}from"./sweetalert2.all-87237c48.js";import{_ as M,g as F,u as S,x as E,y as V,z as C,B,f as b,o as y,c as w,b as f,a as o,j as x,w as _,v as D,k as H,t as N,F as P,D as A,E as v,l as U,r as m,m as R,n as G,d as k}from"./index-9268eda1.js";const K={name:"CreateArticleView",beforeRouteEnter(i,e,r){const d=i.params.articleId,l=i.params.articleType,t=d.split("-").pop();l==="berita"?Promise.all([F(t),S(t,$cookies.get("ltoken"))]).then(a=>{const n=a.filter(c=>c.success===!0);if(n.length>=1){const c=n[0].message[0];encodeURIComponent(`${c.title.replaceAll(/\s+/g,"-").toLowerCase()}-${t}`)===encodeURIComponent(d)&&r(g=>{g.article=c,g.articleType="news",g.isArticleExists=!0,g.isLoading=!1})}else r({name:"not-found"})}).catch(()=>{r({name:"not-found"})}):l==="pengumuman"&&Promise.all([E(t),V(t,$cookies.get("ltoken"))]).then(a=>{const n=a.filter(c=>c.success===!0);if(n.length>=1){const c=n[0].message[0];encodeURIComponent(`${c.title.replaceAll(/\s+/g,"-").toLowerCase()}-${t}`)===encodeURIComponent(d)&&r(g=>{g.article=c,g.articleType="announcements",g.isArticleExists=!0,g.isLoading=!1})}else r({name:"not-found"})}).catch(()=>{r({name:"not-found"})})},components:{Header:I,QuillEditor:T},setup(){return{modules:[{name:"imageUploader",module:L,options:{upload:r=>new Promise((d,l)=>{const t=$cookies.get("ltoken");t===null&&l("Kamu perlu login untuk melakukan aksi ini"),b(t,"imagekit-private").then(a=>{if(a.success){const n=a.message;p(r,n).then(c=>{d(c.url)})}})})}}],toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],[{color:[]},{background:[]}],["link","image","video"],["clean"]]}},created(){this.$cookies.get("ltoken")===null&&this.$router.push({name:"login"})},data(){return{article:"",isArticleExists:!1,isLoading:!0,articleTitle:"",articleHeaderImg:"",editorValue:"",articleType:"Pilih tipe artikel",articleStatus:"Drafting",showLoadingModal:!1}},mounted(){this.articleTitle=this.article.title,this.articleHeaderImg="not null",this.editorValue=this.article.contents},methods:{deleteArticle(){s.fire({title:"Apakah Anda yakin?",text:"Anda tidak akan dapat mengembalikan artikel ini!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",cancelButtonText:"Batal",confirmButtonText:"Ya, hapus artikel!"}).then(i=>{if(i.isConfirmed){this.showLoadingModal=!0,this.articleStatus="Deleting";const e=this.$cookies.get("ltoken");if(e===null){this.showLoadingModal=!1,alert("Kamu perlu login untuk melakukan aksi ini");return}this.articleType==="announcements"?C(this.article.id,e).then(r=>{this.showLoadingModal=!1,r.success?s.fire("Success!","Artikel berhasil dihapus!","success").then(()=>{this.$router.push({name:"main"})}):s.fire({icon:"error",title:"Failed!",text:"Gagal menghapus artikel"})}).catch(r=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Gagal menghapus artikel"})}):this.articleType==="news"&&B(this.article.id,e).then(r=>{this.showLoadingModal=!1,r.success?s.fire("Success!","Artikel berhasil dihapus!","success").then(()=>{this.$router.push({name:"main"})}):s.fire({icon:"error",title:"Failed!",text:"Gagal menghapus artikel"})}).catch(r=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Gagal menghapus artikel"})})}})},draftArticle(){this.showLoadingModal=!0,this.articleStatus="Drafting";const i=this.$cookies.get("ltoken");if(i===null){alert("Kamu perlu login untuk melakukan aksi ini");return}b(i,"imagekit-private").then(e=>{if(e.success){const r=e.message,d=t=>{const a={is_draft:!0};this.articleTitle!==this.article.title&&(a.title=this.articleTitle),t!==this.article.image_header_url&&(a.image_header_url=t),this.editorValue!==this.article.contents&&(a.contents=this.editorValue),this.articleType==="announcements"?A(this.article.id,a,i).then(n=>{this.showLoadingModal=!1,n.success?s.fire("Success!","Artikel berhasil diedit dan didraft!","success"):s.fire({icon:"error",title:"Failed!",text:"Artikel gagal didraft!"})}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal didraft!"})}):this.articleType==="news"&&v(this.article.id,a,i).then(n=>{this.showLoadingModal=!1,n.success?s.fire("Success!","Artikel berhasil diedit dan didraft!","success"):s.fire({icon:"error",title:"Failed!",text:"Artikel gagal didraft!"})}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal didraft!"})})},l=document.getElementById("file_input").files[0];l!==void 0?p(l,r).then(t=>{const a=t.url;d(a)}):d(this.article.image_header_url)}}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal didraft!"})})},publishArticle(){this.showLoadingModal=!0,this.articleStatus="Publishing";const i=this.$cookies.get("ltoken");if(i===null){alert("Kamu perlu login untuk melakukan aksi ini");return}b(i,"imagekit-private").then(e=>{if(e.success){const r=e.message,d=t=>{const a={is_draft:!1};this.articleTitle!==this.article.title&&(a.title=this.articleTitle),t!==this.article.image_header_url&&(a.image_header_url=t),this.editorValue!==this.article.contents&&(a.contents=this.editorValue),this.articleType==="announcements"?A(this.article.id,a,i).then(n=>{this.showLoadingModal=!1,n.success?s.fire("Success!","Artikel berhasil diedit dan dipublikasikan!","success"):s.fire({icon:"error",title:"Failed!",text:"Artikel gagal dipublikasikan!"})}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal dipublikasikan!"})}):this.articleType==="news"&&v(this.article.id,a,i).then(n=>{this.showLoadingModal=!1,n.success?s.fire("Success!","Artikel berhasil diedit dan dipublikasikan!","success"):s.fire({icon:"error",title:"Failed!",text:"Artikel gagal dipublikasikan!"})}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal dipublikasikan!"})})},l=document.getElementById("file_input").files[0];l!==void 0?p(l,r).then(t=>{const a=t.url;d(a)}):d(this.article.image_header_url)}}).catch(()=>{this.showLoadingModal=!1,s.fire({icon:"error",title:"Failed!",text:"Artikel gagal dipublikasikan!"})})},getHeaderImg(i){const e=document.getElementById("file_input").files[0],r=new FileReader;r.onloadend=function(){i(r.result)},r.readAsDataURL(e)},updatePreview(){this.getHeaderImg(i=>{this.articleHeaderImg=i,setTimeout(()=>{document.getElementById("preview-img").src=i},100)})}}},h=i=>(R("data-v-cef417b5"),i=i(),G(),i),Q={class:"mt-12 mb-12 container mx-auto max-w-screen-lg px-8 lg:px-0"},j=h(()=>o("label",{class:"block mb-2 text-sm text-gray-900 dark:text-white",for:"file_input"},[k(" Gambar header artikel "),o("span",{class:"text-red-600"},"*")],-1)),Y=["src"],z=h(()=>o("label",{for:"article-title",class:"mb-2 text-sm text-gray-900"},[k(" Judul artikel "),o("span",{class:"text-red-600"},"*")],-1)),J=h(()=>o("label",{class:"mb-2 text-sm text-gray-900"},[k(" Isi artikel "),o("span",{class:"text-red-600"},"*")],-1)),q=h(()=>o("label",{for:"article-type",class:"block mt-4 mb-1 text-sm text-gray-900 dark:text-white"},[k(" Tipe Artikel "),o("span",{class:"text-red-600"},"*")],-1)),O=h(()=>o("option",{selected:"",disabled:""},"Pilih tipe artikel",-1)),W=h(()=>o("option",{value:"announcements",disabled:""},"Pengumuman",-1)),X=h(()=>o("option",{value:"news",disabled:""},"Berita",-1)),Z=[O,W,X],$=h(()=>o("br",null,null,-1)),ee={key:0,id:"loading-modal",class:"fade-in fixed top-0 left-0 z-50 w-screen h-screen flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.5)"}},te={class:"bg-white border py-14 px-20 rounded-lg flex items-center flex-col"},ie=U('<div class="loader-dots block relative w-20 h-5 mt-2" data-v-cef417b5><div class="absolute top-0 mt-1 w-3 h-3 rounded-full bg-green-500" data-v-cef417b5></div><div class="absolute top-0 mt-1 w-3 h-3 rounded-full bg-green-500" data-v-cef417b5></div><div class="absolute top-0 mt-1 w-3 h-3 rounded-full bg-green-500" data-v-cef417b5></div><div class="absolute top-0 mt-1 w-3 h-3 rounded-full bg-green-500" data-v-cef417b5></div></div>',1),ae={class:"text-gray-500 text-base font-medium mt-5 text-center"};function re(i,e,r,d,l,t){const a=m("Navbar"),n=m("Header"),c=m("QuillEditor"),g=m("Footer");return y(),w(P,null,[f(a),f(n,{class:"pt-10 pb-10",title:"Edit Artikel"}),o("div",Q,[j,o("input",{onChange:e[0]||(e[0]=(...u)=>t.updatePreview&&t.updatePreview(...u)),class:"mb-2 block w-full text-sm text-gray-900 border border-gray-300 rounded-sm cursor-pointer dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400",id:"file_input",type:"file",accept:"image/*"},null,32),l.articleHeaderImg!==""?(y(),w("img",{key:0,id:"preview-img",src:l.article.image_header_url,class:"mb-4 rounded-sm aspect-video w-full object-contain",style:{"background-color":"#d0d1d3"},alt:"Article header image"},null,8,Y)):x("",!0),z,_(o("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>l.articleTitle=u),type:"text",id:"article-title",class:"transition duration-50 block w-full p-2.5 mb-4 text-sm text-gray-900 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Judul artikel",required:""},null,512),[[D,l.articleTitle]]),J,f(c,{modules:d.modules,theme:"snow",toolbar:d.toolbar,content:l.editorValue,"onUpdate:content":e[2]||(e[2]=u=>l.editorValue=u),"content-type":"html"},null,8,["modules","toolbar","content"]),q,_(o("select",{"onUpdate:modelValue":e[3]||(e[3]=u=>l.articleType=u),id:"article-type",class:"transition duration-50 border border-gray-300 text-gray-900 text-sm focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",disabled:""},Z,512),[[H,l.articleType]]),o("button",{onClick:e[4]||(e[4]=(...u)=>t.deleteArticle&&t.deleteArticle(...u)),type:"button",class:"transition duration-150 mt-3 shadow-sm text-white bg-red-600 hover:bg-red-800 border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-sm text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," Hapus Artikel "),o("button",{onClick:e[5]||(e[5]=(...u)=>t.draftArticle&&t.draftArticle(...u)),type:"button",class:"transition duration-150 mt-3 shadow-sm text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-sm text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," Draf Artikel Yang di Edit "),o("button",{onClick:e[6]||(e[6]=(...u)=>t.publishArticle&&t.publishArticle(...u)),type:"button",class:"transition duration-150 mt-3 text-white bg-blue-600 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-sm text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Publikasikan Artikel Yang di Edit "),$]),l.showLoadingModal?(y(),w("div",ee,[o("div",te,[ie,o("div",ae,N(l.articleStatus)+" Article... ",1)])])):x("",!0),f(g)],64)}const ce=M(K,[["render",re],["__scopeId","data-v-cef417b5"]]);export{ce as default};
